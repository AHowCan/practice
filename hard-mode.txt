This is the hard mode.
